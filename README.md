# Download Garmin Connect Data

[![PyPI][pypi-badge]][pypi-link]
[![Python 3.7][python37-badge]][python37-link]
[![Python 3.8][python38-badge]][python38-link]
[![Build Status][build-badge]][build-link]


This software downloads TCX files and accompanying activity metadata files from
the Garmin Connect website.  Since Garmin has discontinued its API to download
your data this software was written to take its place.  It is the opinion of
the author that this data generated by the athlete should be accessible via an
automated method and not constrained to a Web GUI interface.

Features:
* Download Garmin activity data.
* Track data in an [SQLite] database (avoid re-downloading).
* Sync duration statistics with GoogleSheets.
* Print basic information and statistics on previous activities.
* Convenient importing in your favorite analysis tool (i.e. [GoldenCheetah]).


<!-- markdown-toc start - Don't edit this section. Run M-x markdown-toc-refresh-toc -->
## Table of Contents

- [Obtaining](#obtaining)
- [Data Life Cycle](#data-life-cycle)
- [History](#history)
- [Usage](#usage)
    - [Command Line](#command-line)
- [Changelog](#changelog)
- [License](#license)

<!-- markdown-toc end -->


## Obtaining

The easist way to install the command line program is via the `pip` installer:
```bash
pip install zensols.garmdown
```

Binaries are also available on [pypi].


## Data Life Cycle

1. Download activities.  These are independent blocks of data that provide
   information used to later download the respective TCX file.
2. Download the TCX file.  The TCX file has all the information needed by
   workout analysis applications like [GoldenCheetah].
3. Import TCX file.  This step simply copies downloaded files to a directory
   that's easy to access by the workout analysis application.
4. Ingest TCX files.  Import all files in the import folder to your data
   workout analysis application.  After this step you delete the folder as
   subsequent invocations of step 3 will regenerate it.
5. Backup the activities database.  In the rare case the binary database file
   (see below) might be corrupted, a backup is made every `N` days (where `N`
   is specified in a configuration file).

All state between all of these steps are recorded in an SQLite database, which
is a binary file stored on the file system.  If this doesn't make sense to you,
it means that you shouldn't need to install anything special and it *lives* on
your disk.


# History

The activity download module was inspired by [Shannon's original project],
which was used to navigate the convoluted Garmin client API.


## Usage

The easiest way to use the program is to use the `sync` action repeatedly
until the program doesn't do anything, example:
```bash
$ garmdown sync
```

This invokes all [data life cycle steps](#data-life-cycle), meaning it imports
activities in to the database, downloads the TCX files and creates a handy
import directory (by default in your desktop directory `~/Desktop/to-import`).

### Command Line

```sql
Usage: usage: garmdown <list|activity|backup|env|import|notdown|notimport|sheet|sync|tcx> [options]

Options:
  --version             show program's version number and exit
  -h, --help            show this help message and exit
  -w NUMBER, --whine=NUMBER
                        add verbosity to logging
  -c FILE, --config=FILE
                        configuration file
Actions:
  activity   Download outstanding activites
  -l, --limit <int>    the limit

  backup     Backup (force) the activites database

  env        Print environment
  -d, --detail         report details of missing data

  import     Import tcx file
  -l, --limit <int>    the limit

  notdown    Print activities not downloaded
  -d, --detail         report details of missing data

  notimport  Print activities not imported
  -d, --detail         report details of missing data

  sheet      Update google docs training spreadsheet

  sync       Download all outstanding data
  -l, --limit <int>    the limit

  tcx        Download outstanding tcx files
  -l, --limit <int>    the limit
```


## Changelog

An extensive changelog is available [here](CHANGELOG.md).


## License

Copyright (c) 2019 Paul Landes

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
of the Software, and to permit persons to whom the Software is furnished to do
so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.


<!-- links -->
[pypi]: https://pypi.org/project/zensols.garmdown/
[pypi-link]: https://pypi.python.org/pypi/zensols.garmdown
[pypi-badge]: https://img.shields.io/pypi/v/zensols.garmdown.svg
[python37-badge]: https://img.shields.io/badge/python-3.7-blue.svg
[python38-badge]: https://img.shields.io/badge/python-3.8-blue.svg
[python37-link]: https://www.python.org/downloads/release/python-370
[python38-link]: https://www.python.org/downloads/release/python-380
[build-badge]: https://github.com/garmin-data/garmdown/workflows/CI/badge.svg
[build-link]: https://github.com/garmin-data/garmdown/actions

[GoldenCheetah]: https://www.goldencheetah.org
[Shannon's original project]: https://github.com/magsol/garmin
[SQLite]: https://www.sqlite.org/index.html
